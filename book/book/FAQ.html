<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>FAQ - Firecracker</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="CHARTER.html"><strong aria-hidden="true">2.</strong> Firecracker Charter</a></li><li class="chapter-item expanded "><a href="CODE_OF_CONDUCT.html"><strong aria-hidden="true">3.</strong> Code of Conduct</a></li><li class="chapter-item expanded "><a href="SECURITY.html"><strong aria-hidden="true">4.</strong> Security</a></li><li class="chapter-item expanded "><a href="getting-started.html"><strong aria-hidden="true">5.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="CONTRIBUTING.html"><strong aria-hidden="true">6.</strong> Contributing</a></li><li class="chapter-item expanded "><a href="dev-machine-setup.html"><strong aria-hidden="true">7.</strong> Development Machine Setup</a></li><li class="chapter-item expanded "><a href="api-change-runbook.html"><strong aria-hidden="true">8.</strong> API Change Runbook</a></li><li class="chapter-item expanded "><a href="RELEASE_POLICY.html"><strong aria-hidden="true">9.</strong> Releases</a></li><li class="chapter-item expanded "><a href="design.html"><strong aria-hidden="true">10.</strong> Design</a></li><li class="chapter-item expanded "><a href="prod-host-setup.html"><strong aria-hidden="true">11.</strong> Production Host Setup</a></li><li class="chapter-item expanded "><a href="network-setup.html"><strong aria-hidden="true">12.</strong> Network Setup</a></li><li class="chapter-item expanded "><a href="kernel-policy.html"><strong aria-hidden="true">13.</strong> Kernel Support Policy</a></li><li class="chapter-item expanded "><a href="SPECIFICATION.html"><strong aria-hidden="true">14.</strong> Specification</a></li><li class="chapter-item expanded "><a href="network-performance.html"><strong aria-hidden="true">15.</strong> Network Performance</a></li><li class="chapter-item expanded "><a href="FAQ.html" class="active"><strong aria-hidden="true">16.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="rootfs-and-kernel-setup.html"><strong aria-hidden="true">17.</strong> Creating Custom rootfs and kernel Images</a></li><li class="chapter-item expanded "><a href="ballooning.html"><strong aria-hidden="true">18.</strong> Ballooning</a></li><li class="chapter-item expanded "><a href="devctr-image.html"><strong aria-hidden="true">19.</strong> Development Container</a></li><li class="chapter-item expanded "><a href="device-api.html"><strong aria-hidden="true">20.</strong> Device API</a></li><li class="chapter-item expanded "><a href="entropy.html"><strong aria-hidden="true">21.</strong> Entropy</a></li><li class="chapter-item expanded "><a href="formal-verification.html"><strong aria-hidden="true">22.</strong> Formal Verification</a></li><li class="chapter-item expanded "><a href="initrd.html"><strong aria-hidden="true">23.</strong> initrd</a></li><li class="chapter-item expanded "><a href="jailer.html"><strong aria-hidden="true">24.</strong> Jailer</a></li><li class="chapter-item expanded "><a href="logger.html"><strong aria-hidden="true">25.</strong> Logger</a></li><li class="chapter-item expanded "><a href="metrics.html"><strong aria-hidden="true">26.</strong> Metrics</a></li><li class="chapter-item expanded "><a href="seccomp.html"><strong aria-hidden="true">27.</strong> Seccomp</a></li><li class="chapter-item expanded "><a href="seccompiler.html"><strong aria-hidden="true">28.</strong> Seccompiler</a></li><li class="chapter-item expanded "><a href="tracing.html"><strong aria-hidden="true">29.</strong> Tracing</a></li><li class="chapter-item expanded "><a href="vsock.html"><strong aria-hidden="true">30.</strong> VSock</a></li><li class="chapter-item expanded "><a href="api-requests.html"><strong aria-hidden="true">31.</strong> API Requests</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="actions.html"><strong aria-hidden="true">31.1.</strong> Actons</a></li><li class="chapter-item expanded "><a href="block-caching.html"><strong aria-hidden="true">31.2.</strong> Block Caching</a></li><li class="chapter-item expanded "><a href="block-io-engine.html"><strong aria-hidden="true">31.3.</strong> Block IO Engine</a></li><li class="chapter-item expanded "><a href="block-vhost-user.html"><strong aria-hidden="true">31.4.</strong> Block VHost User</a></li><li class="chapter-item expanded "><a href="patch-block.html"><strong aria-hidden="true">31.5.</strong> Patch Block</a></li><li class="chapter-item expanded "><a href="patch-network-interface.html"><strong aria-hidden="true">31.6.</strong> Patch Network Interface</a></li></ol></li><li class="chapter-item expanded "><a href="state-serialize.html"><strong aria-hidden="true">32.</strong> State Serialization Benchmarks</a></li><li class="chapter-item expanded "><a href="cpu-templates.html"><strong aria-hidden="true">33.</strong> CPU Templates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="boot-protocol.html"><strong aria-hidden="true">33.1.</strong> Boot Protocol</a></li><li class="chapter-item expanded "><a href="cpu-template-helper.html"><strong aria-hidden="true">33.2.</strong> CPU Template Helper</a></li><li class="chapter-item expanded "><a href="cpuid-normalization.html"><strong aria-hidden="true">33.3.</strong> CPUID Normalization</a></li></ol></li><li class="chapter-item expanded "><a href="mmds.html"><strong aria-hidden="true">34.</strong> MMDS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="mmds-design.html"><strong aria-hidden="true">34.1.</strong> MMDS Design</a></li><li class="chapter-item expanded "><a href="mmds-user-guide.html"><strong aria-hidden="true">34.2.</strong> MMDS User Guide</a></li></ol></li><li class="chapter-item expanded "><a href="snapshotting.html"><strong aria-hidden="true">35.</strong> Snapshotting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="handling-page-faults-on-snapshot-resume.html"><strong aria-hidden="true">35.1.</strong> Handling Page Faults on Snapshot Resume</a></li><li class="chapter-item expanded "><a href="network-for-clones.html"><strong aria-hidden="true">35.2.</strong> Network For Clones</a></li><li class="chapter-item expanded "><a href="random-for-clones.html"><strong aria-hidden="true">35.3.</strong> Random For Clones</a></li><li class="chapter-item expanded "><a href="snapshot-editor.html"><strong aria-hidden="true">35.4.</strong> Snapshot Editor</a></li><li class="chapter-item expanded "><a href="snapshot-support.html"><strong aria-hidden="true">35.5.</strong> Snapshot Support</a></li><li class="chapter-item expanded "><a href="versioning.html"><strong aria-hidden="true">35.6.</strong> Versioning</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Firecracker</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="firecracker-frequently-asked-questions"><a class="header" href="#firecracker-frequently-asked-questions">Firecracker Frequently Asked Questions</a></h1>
<h2 id="about-firecracker"><a class="header" href="#about-firecracker">About Firecracker</a></h2>
<h3 id="what-is-firecracker"><a class="header" href="#what-is-firecracker">What is Firecracker?</a></h3>
<p>Firecracker is an open source Virtual Machine Monitor (VMM) that
enables secure, multi-tenant, minimal-overhead execution of container
and function workloads.</p>
<h3 id="who-developed-firecracker"><a class="header" href="#who-developed-firecracker">Who developed Firecracker?</a></h3>
<p>Firecracker was built by developers at Amazon Web Services to enable services
such as <a href="https://aws.amazon.com/lambda/">AWS Lambda</a> and <a href="https://aws.amazon.com/fargate/">AWS
Fargate</a> to improve resource utilization and
customer experience, while providing the security and isolation required of
public cloud infrastructure. Firecracker started from Chromium OS's Virtual
Machine Monitor,
<a href="https://github.com/google/crosvm">crosvm</a>, an open
source VMM written in Rust. Today, crosvm and Firecracker have diverged to
serve very different customer needs. <a href="https://github.com/rust-vmm">Rust-vmm</a> is
an open source community where we collaborate with the crosvm maintainers and
other groups and individuals to build and share quality Rust virtualization
components.</p>
<h3 id="why-did-you-develop-firecracker"><a class="header" href="#why-did-you-develop-firecracker">Why did you develop Firecracker?</a></h3>
<p>When we launched Lambda in November of 2014, we were focused on providing a
secure <a href="https://aws.amazon.com/serverless/">serverless</a> experience. At launch we
used per-customer EC2 instances to provide strong security and isolation between
customers. As Lambda grew, we saw the need for technology to provide a highly
secure, flexible, and efficient runtime environment for services like Lambda and
Fargate. Using our experience building isolated EC2 instances with hardware
virtualization technology, we started an effort to build a VMM that was tailored
to integrate with container ecosystems.</p>
<h3 id="what-processors-does-firecracker-support"><a class="header" href="#what-processors-does-firecracker-support">What processors does Firecracker support?</a></h3>
<p>The Firecracker VMM is built to be processor agnostic. Intel, AMD and 64 bit ARM
processors are supported for production workloads.</p>
<p>You can find more details <a href="README.html#supported-platforms">here</a>.</p>
<h3 id="can-firecracker-be-used-within-the-container-ecosystem"><a class="header" href="#can-firecracker-be-used-within-the-container-ecosystem">Can Firecracker be used within the container ecosystem?</a></h3>
<p>Yes. Firecracker is integrated with
<a href="https://github.com/kata-containers/documentation/wiki/Initial-release-of-Kata-Containers-with-Firecracker-support">Kata Containers</a>,
<a href="https://www.weave.works/oss/firekube/">Weave FireKube</a> (via
<a href="https://github.com/weaveworks/ignite">Weave Ignite</a>), and containerd via
<a href="https://github.com/firecracker-microvm/firecracker-containerd">firecracker-containerd</a>.
We welcome contributions that enable Firecracker to integrate naturally with the
container ecosystem and provide more choices in how container workloads are
isolated.</p>
<h3 id="what-is-the-difference-between-firecracker-and-qemu"><a class="header" href="#what-is-the-difference-between-firecracker-and-qemu">What is the difference between Firecracker and QEMU?</a></h3>
<p>Firecracker is an
<a href="https://www.redhat.com/en/blog/all-you-need-know-about-kvm-userspace">alternative to QEMU</a>
that is purpose-built for running serverless functions and containers safely and
efficiently, and nothing more. Firecracker is written in Rust, provides a
minimal required device model to the guest operating system while excluding
non-essential functionality (only 6 emulated devices are available: virtio-net,
virtio-balloon, virtio-block, virtio-vsock, serial console, and a minimal
keyboard controller used only to stop the microVM). This, along with a
streamlined kernel loading process enables a &lt; 125 ms startup time and a &lt; 5
MiB memory footprint. The Firecracker process also provides a RESTful control
API, handles resource rate limiting for microVMs, and provides a microVM
metadata service to enable the sharing of configuration data between the host
and guest.</p>
<h3 id="what-operating-systems-are-supported-by-firecracker"><a class="header" href="#what-operating-systems-are-supported-by-firecracker">What operating systems are supported by Firecracker?</a></h3>
<p>Firecracker supports Linux host and guest operating systems as well as
<a href="http://blog.osv.io/blog/2019/04/19/making-OSv-run-on-firecraker/">OSv</a> guests.
Currently supported host/guest kernel versions can be found in the
<a href="docs/kernel-policy.html">kernel support policy</a>.</p>
<h3 id="what-is-the-open-source-license-for-firecracker"><a class="header" href="#what-is-the-open-source-license-for-firecracker">What is the open source license for Firecracker?</a></h3>
<p>Firecracker is licensed under the Apache License, version 2.0, allowing you to
freely use, copy, and distribute your changes under the terms of your choice.
<a href="https://www.apache.org/licenses/LICENSE-2.0">Read more about Apache 2.0</a>.
Crosvm code sections are licensed under a
<a href="https://opensource.org/licenses/BSD-3-Clause">BSD-3-Clause license</a> that also
allows you to use, copy, and distribute your changes under the terms of your
choice.</p>
<h3 id="how-can-i-contribute"><a class="header" href="#how-can-i-contribute">How can I contribute?</a></h3>
<p>Firecracker is an AWS open source project that encourages contributions from
customers and the developer community. Any contribution is welcome as long as it
aligns with our <a href="CHARTER.html">charter</a>. You can learn more about how to
contribute in <a href="CONTRIBUTING.html">CONTRIBUTING.md</a>. You can chat with others in
the community on the <a href="https://firecracker-microvm.slack.com">Firecracker Slack
workspace</a>.</p>
<h3 id="how-is-firecracker-project-governed"><a class="header" href="#how-is-firecracker-project-governed">How is Firecracker project governed?</a></h3>
<p>The Firecracker <a href="MAINTAINERS.html">team at Amazon Web Services</a> owns project
maintainer responsibilities, permissions to merge pull requests, and the ability
to create new Firecracker releases.</p>
<h2 id="technical-faq--troubleshooting"><a class="header" href="#technical-faq--troubleshooting">Technical FAQ &amp; Troubleshooting</a></h2>
<h3 id="can-i-emulate-a-different-architecture-in-the-guest-than-the-one-on-the-host"><a class="header" href="#can-i-emulate-a-different-architecture-in-the-guest-than-the-one-on-the-host">Can I emulate a different architecture in the guest than the one on the host?</a></h3>
<p>Guest operating systems must be built for the same CPU architecture as the
host on which it will run. Firecracker does not support running microVMs on
any architecture other than the one the host is running on. In other words,
running an OS built for a <code>x86_64</code> on an <code>aarch64</code> system will not work, and
vice versa.</p>
<h3 id="i-tried-using-an-initrd-for-boot-but-it-doesnt-seem-to-be-used-is-initrd-supported"><a class="header" href="#i-tried-using-an-initrd-for-boot-but-it-doesnt-seem-to-be-used-is-initrd-supported">I tried using an initrd for boot but it doesn't seem to be used. Is initrd supported?</a></h3>
<p>Initrds are only recently supported in Firecracker. If your release predates
issue <a href="https://github.com/firecracker-microvm/firecracker/issues/208">#228</a>
being resolved, please update.</p>
<h3 id="firecracker-is-not-showing-any-output-on-the-console"><a class="header" href="#firecracker-is-not-showing-any-output-on-the-console">Firecracker is not showing any output on the console.</a></h3>
<p>In order to debug the issue, check the response of the <code>InstanceStart</code> API
request. Possible responses:</p>
<ul>
<li><strong>Error</strong>: Submit a new issue with the label &quot;Support: Failure&quot;.</li>
<li><strong>Success</strong>: If the boot was successful, you should get a response with 204
as the status code.</li>
</ul>
<p>If you have no output in the console, most likely you will have to update the
kernel command line. By default, Firecracker starts with the serial console
disabled for boot time performance reasons.</p>
<p>Example of a kernel valid command
line that enables the serial console (which goes in the <code>boot_args</code> field of
the <code>/boot-source</code> Firecracker API resource):</p>
<pre><code class="language-console">console=ttyS0 reboot=k panic=1 pci=off nomodule
</code></pre>
<h3 id="how-can-i-configure-multiple-ethernet-devices-through-the-kernel-command-line"><a class="header" href="#how-can-i-configure-multiple-ethernet-devices-through-the-kernel-command-line">How can I configure multiple Ethernet devices through the kernel command line?</a></h3>
<p>The <code>ip=</code> boot param in the linux kernel only actually supports configuring a
single interface. Multiple interfaces can be set up in Firecracker using the
API, but guest IP configuration at boot time through boot arguments can only be
done for a single interface.</p>
<h3 id="my-guest-wall-clock-is-drifting-how-can-i-fix-it"><a class="header" href="#my-guest-wall-clock-is-drifting-how-can-i-fix-it">My guest wall-clock is drifting, how can I fix it?</a></h3>
<p>The canonical solution is to use NTP in your guests.</p>
<p>However, if you want to run Firecracker at scale, we suggest using a PTP emulated
device as the guest's NTP time source so as to minimize network traffic and
resource overhead. With this solution the guests will constantly update time
to stay in sync with host wall-clock. They do so using cheap para-virtualized
calls into kvm ptp instead of actual network NTP traffic.</p>
<p>To be able to do this you need to have a guest kernel compiled with <code>KVM_PTP</code>
support:</p>
<pre><code class="language-console">CONFIG_PTP_1588_CLOCK=y
CONFIG_PTP_1588_CLOCK_KVM=y
</code></pre>
<p>Our <a href="resources/guest_configs">recommended x86_64 guest kernel config</a>
already has these included.</p>
<p>Now <code>/dev/ptp0</code> should be available in the guest. Next you need to configure
<code>/dev/ptp0</code> as a NTP time source.</p>
<p>For example when using <code>chrony</code>:</p>
<ol>
<li>Add <code>refclock PHC /dev/ptp0 poll 3 dpoll -2 offset 0</code> to the chrony conf
file (<code>/etc/chrony/chrony.conf</code>)</li>
<li>Restart the <code>chrony</code> daemon.</li>
</ol>
<p>You can see more info about the <code>refclock</code> parameters
<a href="https://chrony-project.org/doc/3.4/chrony.conf.html#refclock">here</a>.
Adjust them according to your needs.</p>
<h3 id="each-firecracker-opens-20-file-descriptors-is-this-an-issue"><a class="header" href="#each-firecracker-opens-20-file-descriptors-is-this-an-issue">Each Firecracker opens 20+ file descriptors. Is this an issue?</a></h3>
<p>The relatively high FD usage is expected and correct. Firecracker heavily
relies on event file descriptors to drive device emulation.</p>
<h3 id="how-does-network-interface-numbering-work"><a class="header" href="#how-does-network-interface-numbering-work">How does network interface numbering work?</a></h3>
<p>There is no relation between the numbering of the <code>/network-interface</code> API calls
and the number of the network interface in the guest. Rather, it is usually
the order of network interface creation that determines the number in the guest
(but this depends on the distribution).</p>
<p>For example, when you create two network interfaces by calling
<code>/network-interfaces/1</code> and then <code>/network-interfaces/0</code>, it may result in this
mapping:</p>
<pre><code class="language-console">/network-interfaces/1 -&gt; eth0
/network-interfaces/0 -&gt; eth1
</code></pre>
<h3 id="how-can-i-gracefully-reboot-the-guest-how-can-i-gracefully-poweroff-the-guest"><a class="header" href="#how-can-i-gracefully-reboot-the-guest-how-can-i-gracefully-poweroff-the-guest">How can I gracefully reboot the guest? How can I gracefully poweroff the guest?</a></h3>
<p>Firecracker does not implement ACPI and PM devices, therefore operations like
gracefully rebooting or powering off the guest are supported in unconventional ways.</p>
<p>Running the <code>poweroff</code> or <code>halt</code> commands inside a Linux guest will bring it
down but Firecracker process remains unaware of the guest shutdown so it lives
on.</p>
<p>Running the <code>reboot</code> command in a Linux guest will gracefully bring down the guest
system and also bring a graceful end to the Firecracker process.</p>
<p>On <code>x86_64</code> systems, issuing a <code>SendCtrlAltDel</code> action command through the
Firecracker API will generate a <code>Ctrl + Alt + Del</code> keyboard event in the guest
which triggers a behavior identical to running the <code>reboot</code> command. This is,
however, not supported on <code>aarch64</code> systems.</p>
<h3 id="how-can-i-create-my-own-rootfs-or-kernel-images"><a class="header" href="#how-can-i-create-my-own-rootfs-or-kernel-images">How can I create my own rootfs or kernel images?</a></h3>
<p>Check out our <a href="docs/rootfs-and-kernel-setup.html">rootfs and kernel image creation guide</a>.</p>
<h3 id="we-are-seeing-page-allocation-failures-from-firecracker-in-the-dmesg-output"><a class="header" href="#we-are-seeing-page-allocation-failures-from-firecracker-in-the-dmesg-output">We are seeing page allocation failures from Firecracker in the <code>dmesg</code> output.</a></h3>
<p>If you see errors like ...</p>
<pre><code class="language-console">[&lt;TIMESTAMP&gt;] fc_vmm: page allocation failure: order:6, mode:0x140c0c0
(GFP_KERNEL|__GFP_COMP|__GFP_ZERO), nodemask=(null)
[&lt;TIMESTAMP&gt;] fc_vmm cpuset=&lt;GUID&gt; mems_allowed=0
</code></pre>
<p>... then your host is running out of memory. KVM is attempting to do an
allocation of 2^<code>order</code> bytes (in this case, 6) and there aren't sufficient
contiguous pages.</p>
<p>Possible mitigations are:</p>
<ul>
<li>Reduce memory pressure on the host.</li>
<li>Maybe the host has memory but it's too fragmented for the kernel to use. The
allocation above of order 6 means the kernel could not find 2^6
<strong>consecutive</strong> pages. One way to mitigate memory fragmentation is to <a href="https://linuxhint.com/vm_min_free_kbytes_sysctl/">set a
higher value</a> for <code>vm.min_free_kbytes</code>
<ul>
<li>Or investigate other <a href="https://savvinov.com/2019/10/14/memory-fragmentation-the-silent-performance-killer/">mitigations</a></li>
</ul>
</li>
</ul>
<h3 id="how-can-i-configure-and-start-a-microvm-without-sending-api-calls"><a class="header" href="#how-can-i-configure-and-start-a-microvm-without-sending-api-calls">How can I configure and start a microVM without sending API calls?</a></h3>
<p>Passing an optional command line parameter, <code>--config-file</code>, to the Firecracker
process allows this type of configuration. This parameter must be the path to a
file that contains the JSON specification that will be used to configure and start
the microVM. One example of such file can be found at <code>tests/framework/vm_config.json</code>.</p>
<h3 id="firecracker-fails-to-start-and-returns-an-out-of-memory-error"><a class="header" href="#firecracker-fails-to-start-and-returns-an-out-of-memory-error">Firecracker fails to start and returns an Out of Memory error</a></h3>
<p>If the Firecracker process exits with <code>12</code> exit code (<code>Out of memory</code> error),
the root cause is that there is not enough memory on the host to be used by the
Firecracker microVM.</p>
<p>If the microVM was not configured in terms of memory size through an API request,
the host needs to meet the minimum requirement in terms of free memory size,
namely 128 MB of free memory which the microVM defaults to.</p>
<p>This may be related to &quot;We are seeing page allocation failures ...&quot; above. To
validate, run this:</p>
<pre><code class="language-sh">sudo dmesg | grep &quot;page allocation failure&quot;
</code></pre>
<h3 id="firecracker-fails-to-start-and-returns-resource-busy-error"><a class="header" href="#firecracker-fails-to-start-and-returns-resource-busy-error">Firecracker fails to start and returns &quot;Resource busy&quot; error</a></h3>
<p>If another hypervisor like VMware or VirtualBox is running on the host and
locks <code>/dev/kvm</code>, Firecracker process will fail to start with &quot;Resource busy&quot;
error.</p>
<p>This issue can be resolved by terminating the other hypervisor running on the host,
and allowing Firecracker to start.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="network-performance.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="rootfs-and-kernel-setup.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="network-performance.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="rootfs-and-kernel-setup.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
