<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Network For Clones - Firecracker</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="CHARTER.html"><strong aria-hidden="true">2.</strong> Firecracker Charter</a></li><li class="chapter-item expanded "><a href="CODE_OF_CONDUCT.html"><strong aria-hidden="true">3.</strong> Code of Conduct</a></li><li class="chapter-item expanded "><a href="SECURITY.html"><strong aria-hidden="true">4.</strong> Security</a></li><li class="chapter-item expanded "><a href="getting-started.html"><strong aria-hidden="true">5.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="CONTRIBUTING.html"><strong aria-hidden="true">6.</strong> Contributing</a></li><li class="chapter-item expanded "><a href="dev-machine-setup.html"><strong aria-hidden="true">7.</strong> Development Machine Setup</a></li><li class="chapter-item expanded "><a href="api-change-runbook.html"><strong aria-hidden="true">8.</strong> API Change Runbook</a></li><li class="chapter-item expanded "><a href="RELEASE_POLICY.html"><strong aria-hidden="true">9.</strong> Releases</a></li><li class="chapter-item expanded "><a href="design.html"><strong aria-hidden="true">10.</strong> Design</a></li><li class="chapter-item expanded "><a href="prod-host-setup.html"><strong aria-hidden="true">11.</strong> Production Host Setup</a></li><li class="chapter-item expanded "><a href="network-setup.html"><strong aria-hidden="true">12.</strong> Network Setup</a></li><li class="chapter-item expanded "><a href="kernel-policy.html"><strong aria-hidden="true">13.</strong> Kernel Support Policy</a></li><li class="chapter-item expanded "><a href="SPECIFICATION.html"><strong aria-hidden="true">14.</strong> Specification</a></li><li class="chapter-item expanded "><a href="network-performance.html"><strong aria-hidden="true">15.</strong> Network Performance</a></li><li class="chapter-item expanded "><a href="FAQ.html"><strong aria-hidden="true">16.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="rootfs-and-kernel-setup.html"><strong aria-hidden="true">17.</strong> Creating Custom rootfs and kernel Images</a></li><li class="chapter-item expanded "><a href="ballooning.html"><strong aria-hidden="true">18.</strong> Ballooning</a></li><li class="chapter-item expanded "><a href="devctr-image.html"><strong aria-hidden="true">19.</strong> Development Container</a></li><li class="chapter-item expanded "><a href="device-api.html"><strong aria-hidden="true">20.</strong> Device API</a></li><li class="chapter-item expanded "><a href="entropy.html"><strong aria-hidden="true">21.</strong> Entropy</a></li><li class="chapter-item expanded "><a href="formal-verification.html"><strong aria-hidden="true">22.</strong> Formal Verification</a></li><li class="chapter-item expanded "><a href="initrd.html"><strong aria-hidden="true">23.</strong> initrd</a></li><li class="chapter-item expanded "><a href="jailer.html"><strong aria-hidden="true">24.</strong> Jailer</a></li><li class="chapter-item expanded "><a href="logger.html"><strong aria-hidden="true">25.</strong> Logger</a></li><li class="chapter-item expanded "><a href="metrics.html"><strong aria-hidden="true">26.</strong> Metrics</a></li><li class="chapter-item expanded "><a href="seccomp.html"><strong aria-hidden="true">27.</strong> Seccomp</a></li><li class="chapter-item expanded "><a href="seccompiler.html"><strong aria-hidden="true">28.</strong> Seccompiler</a></li><li class="chapter-item expanded "><a href="tracing.html"><strong aria-hidden="true">29.</strong> Tracing</a></li><li class="chapter-item expanded "><a href="vsock.html"><strong aria-hidden="true">30.</strong> VSock</a></li><li class="chapter-item expanded "><a href="api-requests.html"><strong aria-hidden="true">31.</strong> API Requests</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="actions.html"><strong aria-hidden="true">31.1.</strong> Actons</a></li><li class="chapter-item expanded "><a href="block-caching.html"><strong aria-hidden="true">31.2.</strong> Block Caching</a></li><li class="chapter-item expanded "><a href="block-io-engine.html"><strong aria-hidden="true">31.3.</strong> Block IO Engine</a></li><li class="chapter-item expanded "><a href="block-vhost-user.html"><strong aria-hidden="true">31.4.</strong> Block VHost User</a></li><li class="chapter-item expanded "><a href="patch-block.html"><strong aria-hidden="true">31.5.</strong> Patch Block</a></li><li class="chapter-item expanded "><a href="patch-network-interface.html"><strong aria-hidden="true">31.6.</strong> Patch Network Interface</a></li></ol></li><li class="chapter-item expanded "><a href="state-serialize.html"><strong aria-hidden="true">32.</strong> State Serialization Benchmarks</a></li><li class="chapter-item expanded "><a href="cpu-templates.html"><strong aria-hidden="true">33.</strong> CPU Templates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="boot-protocol.html"><strong aria-hidden="true">33.1.</strong> Boot Protocol</a></li><li class="chapter-item expanded "><a href="cpu-template-helper.html"><strong aria-hidden="true">33.2.</strong> CPU Template Helper</a></li><li class="chapter-item expanded "><a href="cpuid-normalization.html"><strong aria-hidden="true">33.3.</strong> CPUID Normalization</a></li></ol></li><li class="chapter-item expanded "><a href="mmds.html"><strong aria-hidden="true">34.</strong> MMDS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="mmds-design.html"><strong aria-hidden="true">34.1.</strong> MMDS Design</a></li><li class="chapter-item expanded "><a href="mmds-user-guide.html"><strong aria-hidden="true">34.2.</strong> MMDS User Guide</a></li></ol></li><li class="chapter-item expanded "><a href="snapshotting.html"><strong aria-hidden="true">35.</strong> Snapshotting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="handling-page-faults-on-snapshot-resume.html"><strong aria-hidden="true">35.1.</strong> Handling Page Faults on Snapshot Resume</a></li><li class="chapter-item expanded "><a href="network-for-clones.html" class="active"><strong aria-hidden="true">35.2.</strong> Network For Clones</a></li><li class="chapter-item expanded "><a href="random-for-clones.html"><strong aria-hidden="true">35.3.</strong> Random For Clones</a></li><li class="chapter-item expanded "><a href="snapshot-editor.html"><strong aria-hidden="true">35.4.</strong> Snapshot Editor</a></li><li class="chapter-item expanded "><a href="snapshot-support.html"><strong aria-hidden="true">35.5.</strong> Snapshot Support</a></li><li class="chapter-item expanded "><a href="versioning.html"><strong aria-hidden="true">35.6.</strong> Versioning</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Firecracker</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="network-connectivity-for-clones"><a class="header" href="#network-connectivity-for-clones">Network Connectivity for Clones</a></h1>
<p>This document presents the strategy to ensure continued network connectivity
for multiple clones created from a single Firecracker microVM snapshot.
This document also provides an overview of the scalability benchmarks we
performed.</p>
<h2 id="setup"><a class="header" href="#setup">Setup</a></h2>
<p>There are two things which prevent network connectivity from resuming
out-of-the-box for clones created from the same snapshot: Firecracker currently
saves and attempts to restore network devices using the initially
configured TAP names, and each guest will be resumed with the same
network configuration, most importantly with the same IP address(es).
To work around the former, each clone should be started within a
separate network namespace (we can have multiple TAP interfaces with the
same name, as long as they reside in distinct network namespaces).
The latter can be mitigated by leveraging <code>iptables</code> <code>SNAT</code> and <code>DNAT</code>
support. We choose a clone address (<strong>CA</strong>) for each clone, which is the
new address that’s going to represent the guest, and make it so all
packets leaving the VM have their source address rewritten to CA,
and all incoming packets with the destination address equal to CA
have it rewritten to the IP address configured inside the guest (which
remains the same for all clones). Each individual clone continues to
believe it’s using the original address, but outside the VM packets are
assigned a different one for every clone.</p>
<p>Let’s have a more detailed look at this approach. We assume each VM has
a single network interface attached. If multiple interfaces with full
connectivity are required, we simply repeat the relevant parts of this
process for each additional interface. A typical setup right before
taking a snapshot involves having a VM with a network interface backed
by a TAP device (named <code>vmtap0</code>, for example) with an IP address
(referred to as the TAP IP address, for example <code>192.168.241.1/29</code>), and
an IP address configured inside the guest for the corresponding virtio
device (referred to as the guest IP address, for example
<code>192.168.241.2/29</code>).</p>
<h3 id="network-namespaces"><a class="header" href="#network-namespaces">Network namespaces</a></h3>
<p>Attempting to restore multiple clones from the same snapshot faces the
problem of every single one of them attempting to use a TAP device with
the original name, which is not possible by default. Therefore, we need
to start each clone in a separate network namespace. This is already
possible using the netns jailer parameter, described in the
<a href="../jailer.html">documentation</a>. The specified namespace must already
exist, so we have to create it first using</p>
<pre><code class="language-bash">sudo ip netns add fc0
</code></pre>
<p>(where <code>fc0</code> is the name of the network namespace we plan to use for
this specific clone - <code>clone0</code>). A new network namespace is initially
empty, so we also have to create a new tap interface within using</p>
<pre><code class="language-bash">sudo ip netns exec fc0 ip tuntap add name vmtap0 mode tap
</code></pre>
<p>The <code>ip netns exec &lt;ns_name&gt; &lt;command&gt;</code> allows us to execute <code>command</code>
in the context of the specified network namespace (in the previous case,
the secondary command creates a new tap interface). Next we configure
the new TAP interface to match the expectations of the snapshotted guest
by running</p>
<pre><code class="language-bash">sudo ip netns exec fc0 ip addr add 192.168.241.1/29 dev vmtap0
sudo ip netns exec fc0 ip link set vmtap0 up
</code></pre>
<p>At this point we can start multiple clones, each in its separate
namespace, but they won’t have connectivity to the rest of the host,
only the respective TAP interfaces. However, interaction over the
network is still possible; for example we can connect over ssh to
clone0 using</p>
<pre><code class="language-bash">sudo ip netns exec fc0 ssh root@192.168.241.2
</code></pre>
<h3 id="veth-interfaces-to-connect-the-network-namespaces"><a class="header" href="#veth-interfaces-to-connect-the-network-namespaces"><code>veth</code> interfaces to connect the network namespaces</a></h3>
<p>In order to obtain full connectivity we have to begin by connecting the
network namespace to the rest of the host, and then solving the
<em>“same guest IP”</em> problem. The former requires the use of <code>veth</code>
pairs - <em>virtual interfaces that are link-local to each other (any
packet sent through one end of the pair is immediately received on the
other, and the other way around)</em>.
One end resides inside the network namespace, while the other is moved
into the parent namespace (the host global namespace in this case),
and packets flow in or out according to the network configuration. We
have to pick IP addresses for both ends of the veth pair. For clone
index <code>idx</code>, let’s use <code>10.&lt;idx / 30&gt;.&lt;(idx % 30) * 8&gt;.1/24</code> for the
endpoint residing in the host namespace, and the same address ending
with <code>2</code> for the other end which remains inside the clone's namespace.
Thus, for <code>clone 0</code> the former is <code>10.0.0.1</code> and the latter <code>10.0.0.2</code>.</p>
<p>The first endpoint must have an unique name on the host, for example
chosen as <code>veth(idx + 1) (so veth1 for clone 0)</code>. To create and setup
the veth pair, we use the following commands (for namespace <code>fc0</code>):</p>
<pre><code class="language-bash"># create the veth pair inside the namespace
sudo ip netns exec fc0 ip link add veth1 type veth peer name veth0
# move veth1 to the global host namespace
sudo ip netns exec fc0 ip link set veth1 netns 1

sudo ip netns exec fc0 ip addr add 10.0.0.2/24 dev veth0
sudo ip netns exec fc0 ip link set dev veth0 up

sudo ip addr add 10.0.0.1/24 dev veth1
sudo ip link set dev veth1 up

# designate the outer end as default gateway for packets leaving the namespace
sudo ip netns exec fc0 ip route add default via 10.0.0.1
</code></pre>
<h3 id="iptables-rules-for-end-to-end-connectivity"><a class="header" href="#iptables-rules-for-end-to-end-connectivity"><code>iptables</code> rules for end-to-end connectivity</a></h3>
<p>The last step involves adding the <code>iptables</code> rules which change the
source/destination IP address of packets on the fly (thus allowing all
clones to have the same internal IP). We need to choose a clone address,
which is unique on the host for each VM. In the demo, we use
<code>192.168.&lt;idx / 30&gt;.&lt;(idx % 30) * 8 + 3&gt;</code> (which is <code>192.168.0.3</code> for
<code>clone 0</code>):</p>
<pre><code class="language-bash"># for packets that leave the namespace and have the source IP address of the
# original guest, rewrite the source address to clone address 192.168.0.3
sudo ip netns exec fc0 iptables -t nat -A POSTROUTING -o veth0 \
-s 192.168.241.2 -j SNAT --to 192.168.0.3

# do the reverse operation; rewrites the destination address of packets
# heading towards the clone address to 192.168.241.2
sudo ip netns exec fc0 iptables -t nat -A PREROUTING -i veth0 \
-d 192.168.0.3 -j DNAT —to 192.168.241.2

# (adds a route on the host for the clone address)
sudo ip route add 192.168.0.3 via 10.0.0.2
</code></pre>
<p><strong>Full connectivity to/from the clone should be present at this point.</strong></p>
<p>To make sure the guest also adjusts to the new environment, you can explicitly
clear the ARP/neighbour table in the guest:</p>
<pre><code class="language-bash">ip -family inet neigh flush any
ip -family inet6 neigh flush any
</code></pre>
<p>Otherwise, packets originating from the guest might be using old Link Layer
Address for up to arp cache timeout seconds. After said timeout period,
connectivity will work both ways even without an explicit flush.</p>
<h2 id="scalability-evaluation"><a class="header" href="#scalability-evaluation">Scalability evaluation</a></h2>
<p>We ran synthetic tests to determine the impact of the addtional iptables
rules and namespaces on network performance. We compare the case where
each VM runs as regular Firecracker (gets assigned a TAP interface and a
unique IP address in the global namespace) versus the setup with a
separate network namespace for each VM (together with the veth pair and
additional rules). We refer to the former as the basic case, while the
latter is the ns case. We measure latency with the <code>ping</code> command and
throughput with <code>iperf</code>.</p>
<p>The experiments, ran on an Amazon AWS <code>m5d.metal</code> EC2 instace, go as follows:</p>
<ul>
<li>Set up 3000 network resource slots (different TAP interfaces for the
basic case, and namespaces + everything else for ns). This is mainly
to account for any difference the setup itself might make, even if
there are not as many active endpoints at any given time.</li>
<li>Start 1000 Firecracker VMs, and pick <code>N &lt; 1000</code> as the number of
active VMs that are going to generate network traffic. For ping
experiments, we ping each active VM from the host every 500ms for 30
seconds. For <code>iperf</code> experiments, we measure the average bandwidth of
connections from the host to every active VM lasting 40 seconds.
There is one separate client process per VM.</li>
<li>When <code>N = 100</code>, in the basic case we get average latencies of <code>0.315 ms (0.160/0.430 min/max)</code> for <code>ping</code>, and an average throughput of
<code>2.25 Gbps (1.62/3.21 min/max)</code> per VM for <code>iperf</code>. In the ns case,
the ping results <strong>are bumped higher by around 10-20 us</strong>, while the
<code>iperf</code> results are virtually the same on average, with a higher
minimum (1.73 Gbps) and a lower maximum (3 Gbps).</li>
<li>When <code>N = 1000</code>, we start facing desynchronizations caused by
difficulties in starting (and thus finishing) the client processes all
at the same time, which creates a wider distribution of results. In
the basic case, the average latency for ping  experiments has gone
down to 0.305 ms, the minimum decreased to 0.155 ms, but the maximum
increased to 0.640 ms. The average <code>iperf</code> per VM throughput is around
<code>440 Mbps (110/3936 min/max)</code>. In the ns case, average <code>ping</code> latency
is now <code>0.318 ms (0.170/0.650 min/max)</code>. For <code>iperf</code>, the average
throughput is very close to basic at <code>~430 Mbps</code>, while the minimum
and maximum values are lower at <code>85/3803 Mbps</code>.</li>
</ul>
<p><strong>The above measurements give a significant degree of confidence in the
scalability of the solution</strong> (subject to repeating for different values
of the experimental parameters, if necessary). The increase in latency
is almost negligible considering usual end-to-end delays. The lower
minimum throughput from the iperf measurements might be significant, but
only if that magnitude of concurrent, data-intensive transfers is likely.
Moreover, the basic measurements are close to an absolute upper bound.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="handling-page-faults-on-snapshot-resume.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="random-for-clones.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="handling-page-faults-on-snapshot-resume.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="random-for-clones.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
